# Mipa Tab Manager

标签页管理器，帮助您将浏览器标签页组织成集合，提高浏览效率。

## 功能特性

- 📁 将标签页组织成集合
- 🌈 彩色编码的集合（8种颜色可选）
- 🔍 搜索集合
- 🖱️ 拖放功能：
  - 在集合间拖放标签页
  - 从浏览器窗口拖放打开的标签页到集合
  - 重新排序集合内的标签页
- 🔄 使用 GitHub Gist 在设备间实时同步
- 💾 手动数据导出/导入功能
- 📝 编辑标签页的标题、URL 和描述
- 📱 用户友好的界面，支持弹窗和主应用两种模式
- 🗑️ 删除和重命名集合
- 🔀 重新排序集合
- 📊 在侧边栏查看所有打开的标签页，按窗口分组
- ⏱️ 自动保存会话数据
- 📋 复制标签页链接
- 🔍 支持URL模糊匹配，避免重复添加标签页

## 技术栈

- **前端框架**: 原生 HTML/CSS/JavaScript
- **扩展架构**: Chrome Manifest V3
- **拖放库**: SortableJS
- **图标库**: Font Awesome
- **存储方式**: Chrome Storage API
- **同步机制**: GitHub Gist API

## 安装

1. 克隆或下载此仓库
2. 打开 Chrome 浏览器
3. 转到 `chrome://extensions/`
4. 启用右上角的 "开发者模式"
5. 点击 "加载已解压的扩展程序" 并选择下载的仓库文件夹
6. 扩展程序将被添加到您的 Chrome 浏览器

## 使用方法

### 基本使用

#### 弹窗模式 (快速访问)
1. 点击 Chrome 工具栏中的 Mipa Tab Manager 图标打开弹窗
2. 在弹窗中可以快速查看和搜索所有集合
3. 点击集合旁边的 "+" 按钮将当前活动标签页添加到指定集合
4. 点击 "↓" 图标按钮（位于"My Collection"标题右侧）将当前窗口的所有标签页保存到新集合（自动去重）
5. 点击 "OPEN MIPA" 按钮打开主应用

#### 主应用模式 (完整功能)
主应用分为三个主要区域：
- **顶部导航栏**：包含Gist连接、搜索、扩展/折叠、添加集合、导出/导入按钮
- **集合区域**：显示所有集合及其包含的标签页
- **右侧侧边栏**：显示当前打开的标签页，按窗口分组

在主应用中，您可以：
   - 查看所有集合和标签页
   - 创建、编辑、删除和重命名集合
   - 更改集合颜色（8种颜色可选）
   - 拖放标签页在集合间移动
   - 从侧边栏拖放打开的标签页到集合
   - 编辑标签页的标题、URL 和描述
   - 删除标签页
   - 复制标签页链接
   - 打开所有标签页
   - 关闭当前窗口所有标签页并打开集合中的标签页

### 管理集合

1. **创建集合**：
   - 在主应用中点击顶部导航栏的 "ADD COLLECTION" 按钮
   - 在弹出的表单中输入集合名称
   - 选择一个颜色主题
   - 点击 "SAVE" 按钮完成创建

2. **编辑集合**：
   - **重命名**：点击集合名称进入编辑模式，修改名称后按Enter键保存
   - **更改颜色**：点击集合标题栏上的颜色点，在弹出的颜色选择器中选择新颜色

3. **删除集合**：
   - 点击集合标题栏上的删除按钮（垃圾桶图标）
   - 在弹出的确认对话框中点击 "Delete" 按钮确认删除

4. **展开/折叠集合**：
   - 点击集合标题栏可切换展开/折叠状态
   - 展开时显示集合中的所有标签页，折叠时仅显示集合标题

5. **批量管理**：
   - 点击顶部导航栏的 "EXPAND/COLLAPSE" 按钮可一键展开或折叠所有集合

### 管理标签页

1. **添加标签页**：
   - **弹窗模式**：点击集合旁边的 "+" 按钮添加当前活动标签页
   - **主应用模式**：从右侧侧边栏拖放打开的标签页到目标集合
   - **保存所有标签页**：在弹窗中点击向下箭头图标，或在主应用中使用相关功能
   - **自动去重**：添加标签页时会自动检查URL，避免重复添加

2. **编辑标签页**：
   - 点击标签页上的编辑按钮（笔图标）
   - 在弹出的编辑模态框中修改标题、URL 或描述
   - 点击 "Done" 按钮保存更改，或点击 "Delete" 按钮删除标签页

3. **删除标签页**：
   - 点击标签页上的删除按钮（×图标）
   - 或在编辑模态框中点击 "Delete" 按钮

4. **重新排序标签页**：
   - 在集合内拖放标签页可调整顺序
   - 使用SortableJS实现流畅的拖放体验

5. **复制标签页链接**：
   - 点击标签页上的链接图标（链条图标）
   - 链接将自动复制到剪贴板

6. **打开标签页**：
   - 直接点击标签页卡片即可在新标签页中打开
   - 点击集合标题栏上的向上箭头图标可打开集合中的所有标签页
   - 点击集合标题栏上的上下箭头图标可关闭当前窗口所有标签页并打开集合中的标签页

### 数据同步

#### 使用 GitHub Gist（推荐）

1. 在主应用顶部导航栏点击 "Connect to Gist" 按钮
2. 在弹出的模态框中，输入具有 `gist` 权限的 GitHub Personal Access Token
3. 点击 "Connect" 按钮
4. 系统会自动检查并处理：
   - 如果已有 Mipa gist，会加载并合并数据
   - 如果没有，会创建新的私有 gist
5. 连接成功后，按钮文本变为 "Gist Connected"（绿色背景，带勾选图标）
6. 数据会自动在设备间同步，无需手动操作
7. 在其他设备上，重复上述步骤并使用相同的 GitHub token 即可同步数据

**注意事项**：
- 您的数据会实时自动同步到 gist
- 点击 "Gist Connected" 按钮可登出 gist
- 登出后按钮会恢复为 "Connect to Gist"（蓝色背景）

#### 手动导出/导入

1. **导出数据**：
   - 在主应用顶部导航栏点击 "EXPORT" 按钮
   - 数据将以 JSON 格式下载到您的设备

2. **导入数据**：
   - 在主应用顶部导航栏点击 "IMPORT" 按钮
   - 选择您之前导出的 JSON 文件
   - 数据将被导入到扩展程序中

### 标签页去重机制

扩展程序会自动对URL进行去重处理：
- 对于有效URL，比较 `origin + pathname`（忽略查询参数和哈希值）
- 对于无效URL，使用完整URL进行比较
- 在 "保存所有标签页" 功能和单个标签页添加时都会生效
- 确保每个集合中的标签页都是唯一的

### 搜索功能

- 在弹窗和主应用中都可以使用搜索框
- 可以搜索集合名称
- 输入关键词后会实时过滤显示匹配的集合
- 支持模糊匹配，提高搜索灵活性

## 键盘快捷键

- 当前未配置快捷键

## 要求

- Chrome 浏览器（版本 88 或更高，支持 Manifest V3）
- 用于 Gist 同步的 GitHub 账户（可选）

## 权限

- `tabs`：访问和管理浏览器标签页
- `storage`：在本地存储集合数据
- `https://api.github.com/*`：与 GitHub Gist API 通信以进行数据同步

## GitHub Personal Access Token

要使用 Gist 同步，您需要创建一个具有 `gist` 权限的 GitHub Personal Access Token：

1. 转到 https://github.com/settings/tokens
2. 点击 "Generate new token"
3. 给您的 token 命名
4. 选择 `gist` 权限
5. 点击 "Generate token"
6. 复制 token 并在扩展程序提示时粘贴

## 数据存储

- 本地数据使用 Chrome 的 `chrome.storage.local` API 存储
- GitHub Gist 数据存储在私有 Gist 中
- 您的 GitHub token 存储在本地，绝不会与任何人共享
- JSON 数据采用固定格式存储，确保跨设备同步的一致性

## 项目结构

```
mipa-tab/
├── css/
│   └── styles.css          # 样式文件
├── img/
│   └── mipa.jpg            # 扩展图标
├── js/
│   ├── lib/
│   │   └── sortable.min.js # SortableJS 库
│   ├── background.js       # 后台脚本
│   ├── mipa.js             # 主应用脚本
│   └── popup.js            # 弹窗脚本
├── .gitignore              # Git 忽略文件
├── LICENSE                 # 许可证文件
├── README.md               # 项目说明文档
├── manifest.json           # 扩展配置文件（Manifest V3）
├── mipa.html               # 主应用页面
└── popup.html              # 弹窗页面
```

## 贡献

欢迎提交问题和增强请求！

## 许可证

MIT

## 致谢

- 使用 [SortableJS](https://sortablejs.github.io/Sortable/) 实现拖放功能
- 使用 [Font Awesome](https://fontawesome.com/) 图标
- 感谢所有贡献者和用户
